--Create a table of basic celebrity information


CREATE TABLE celebrity (
    id INTEGER PRIMARY KEY AUTOINCREMENT,    
    name TEXT,
    STARMeter INTEGER,
    birthdate TEXT);

INSERT INTO celebrity (name, STARMeter, birthdate)
    VALUES ('Jhene Aiko', 67, 03-16-1988);
INSERT INTO celebrity (name, STARMeter, birthdate)
    VALUES ('Big Sean', 169, 03-25-1988);
INSERT INTO celebrity (name, STARMeter, birthdate)
    VALUES ('Trevor Noah',220 , 02-20-1985);
INSERT INTO celebrity (name, STARMeter, birthdate)
    VALUES ('Justin Bieber', 330, 03-01-1994);
INSERT INTO celebrity (name, STARMeter, birthdate)
    VALUES ('Hailey Bieber', 75, 11-22-1996);
   

 
-- Create a table of information regarding marital partners

CREATE TABLE spouse (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    partner INTEGER);
 
INSERT INTO spouse (partner)
    VALUES (2);
INSERT INTO spouse (partner)
    VALUES (1);
INSERT INTO spouse (partner)
    VALUES (' ');
INSERT INTO spouse (partner)
    VALUES (5);
INSERT INTO spouse (partner)
    VALUES (4);
   
 
 
 --Create a table regarding a celebrity's nationality  
   
CREATE TABLE nationality (
    celebrity_id INTEGER PRIMARY KEY AUTOINCREMENT,     nationality TEXT,
    city_of_birth TEXT);

INSERT INTO nationality (nationality, city_of_birth)
    VALUES ('American','Los Angeles');
INSERT INTO nationality (nationality, city_of_birth)
    VALUES ('American','Santa Monica');
INSERT INTO nationality (nationality, city_of_birth)
    VALUES ('South African', 'Johannesburg');
INSERT INTO nationality (nationality, city_of_birth)
    VALUES ('Canadian', 'Ontario');
INSERT INTO nationality (nationality, city_of_birth)
    VALUES ('American', 'Tucson');



--List only the celebrities that are married and list who they are married to.
SELECT a.name, b.name AS spouse FROM spouse
JOIN celebrity a
ON spouse.id=a.id
JOIN celebrity b
ON spouse.partner=b.id;



--List the celebrities that are not married.
SELECT a.name, b.name AS spouse FROM spouse
JOIN celebrity a
ON spouse.id=a.id
JOIN celebrity b
ON spouse.partner=b.id
WHERE spouse.partner IS NULL;



-- Where are these celebrities born?

SELECT celebrity.name, nationality.city_of_birth AS 'city of birth'
FROM nationality
JOIN celebrity
ON celebrity.id=nationality.celebrity_id;



--List all celebrities, even those without a spouse, and their spouses with each respective STARMeter rating.

SELECT a.name, a.STARMeter, b.name, b.STARMeter FROM spouse
JOIN celebrity a
ON spouse.id = a.id
LEFT JOIN celebrity b
ON spouse.partner = b.id;



-- List celebrity and their respective spouses nationality

SELECT a.name,a.nationality, b.name AS spouse, b.nationality FROM spouse
LEFT JOIN celebrity a
ON spouse.id = a.id
JOIN celebrity b
ON spouse.partner = b.id
JOIN nationality a
ON a.id = a.celebrity_id
JOIN nationality b
ON a.id = b.celebrity_id;

